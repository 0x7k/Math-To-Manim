# CLAUDE.md

This file provides guidance to Claude Code (claude.ai/code) when working with code in this repository.

## Project Overview

Math-To-Manim is a mathematical animation generation system that transforms detailed LaTeX-rich prompts into Manim animations using AI models (DeepSeek, Google Gemini, Grok3). The repository contains generated animation scripts, not the AI pipeline itself.

## Key Commands

### Dependencies Management

Using Poetry (preferred):
```bash
poetry install          # Install all dependencies
poetry shell           # Activate virtual environment
```

Using pip (alternative):
```bash
pip install -r requirements.txt
```

### Running Tests
```bash
poetry run test                    # Run all tests
poetry run pytest -m unit          # Run unit tests only
poetry run pytest -m integration   # Run integration tests
poetry run pytest --cov=Scripts    # Run with coverage reporting
```

### Running the Application
```bash
python app.py    # Launch Gradio web interface
```

### Rendering Animations
```bash
# Development (quick preview at 480p)
python -m manim -pql Scripts/ScriptName.py SceneName

# High quality render (1080p)
python -m manim -qh Scripts/ScriptName.py SceneName

# Render with specific options
python -m manim -qh -p -f Scripts/ScriptName.py SceneName
```

Quality options: `-ql` (480p), `-qm` (720p), `-qh` (1080p), `-qk` (4K)
Additional flags: `-p` (preview), `-f` (show in file browser)

### Code Quality
```bash
black Scripts/               # Format Python code
```

## Architecture Overview

The codebase consists of:

1. **Scripts/** - Contains all Manim animation scripts generated by AI models. Each script is a standalone animation that can be rendered independently.

2. **app.py** - Gradio web interface for interacting with AI models. Handles API communication with DeepSeek, Gemini, and Grok3.

3. **smolagent_prototype.py** - Prototype implementation for the upcoming smolagents integration that will transform simple prompts into detailed LaTeX-rich prompts.

4. **tests/** - Testing infrastructure with shared fixtures for mocking Manim configurations, API clients, and temporary directories.

## Key Patterns

### Animation Scripts
- Each script in Scripts/ is self-contained and follows Manim's Scene-based structure
- Scripts require extremely detailed prompts with LaTeX formatting for successful generation
- Common imports: `from manim import *`

### API Integration
- API keys are loaded from environment variables (`.env` file)
- DeepSeek is the primary model, with Gemini and Grok3 as supplementary options
- The system expects LaTeX-heavy prompts for best results

### Testing
- Pytest configuration with coverage requirements (80% minimum)
- Test markers: `@pytest.mark.unit`, `@pytest.mark.integration`, `@pytest.mark.slow`
- Comprehensive fixtures in `tests/conftest.py` for mocking external dependencies

## Important Considerations

1. **FFmpeg Requirement**: Manim requires FFmpeg for video rendering. Ensure it's installed and accessible in PATH.

2. **Prompt Detail**: AI models require extremely detailed, LaTeX-rich prompts. Simple prompts will not produce good results until the smolagents integration is complete.

3. **Python Version**: Requires Python 3.10+ (upgraded from 3.8+ due to smolagents dependency).

4. **GPU Usage**: While not required for rendering, GPU acceleration can significantly speed up both AI inference and video rendering.

5. **Output Location**: Rendered animations are saved in `media/videos/SceneName/[quality]/`